function resourceCallBack(){cc.game.onStart=function(){cc.view.adjustViewPort(!0),thisismobile?cc.view.setDesignResolutionSize(640,1024,cc.ResolutionPolicy.EXACT_FIT):cc.view.setDesignResolutionSize(640,1024,cc.ResolutionPolicy.SHOW_ALL),cc.view.resizeWithBrowserSize(!0),MyLoaderScene.preload(g_resources,function(){cc.director.runScene(new gameScene)},this)},cc.game.run("gameCanvas")}var downSpr=cc.Sprite.extend({ctor:function(a,b,c){this._super(a,b),this.initWithFile(a),this.type=b,this.layer=c,this.loadListener(),this.scheduleUpdate()},addAnimation:function(a){var b=cc.textureCache.addImage(a),c=[];c[0]=new cc.SpriteFrame(b,cc.rect(0,0,100,148)),c[1]=new cc.SpriteFrame(b,cc.rect(100,0,100,148));var d=new cc.Animation(c,.3),e=new cc.animate(d);e.repeatForever();this.runAction(e)},loadListener:function(){var a=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,target:this,swallowTouches:!0,onTouchBegan:this.onTouchBegan,onTouchMoved:this.onTouchMoved,onTouchEnded:this.onTouchEnded});cc.eventManager.addListener(a,this)},onTouchBegan:function(a,b){var c=this.target,d=c.convertToNodeSpace(a.getLocation()),e=c.getContentSize(),f=cc.rect(0,0,e.width,e.height);return cc.rectContainsPoint(f,d)?!0:!1},onTouchMoved:function(a,b){var c=this.target;c.onTouchDispose(a,b)},onTouchEnded:function(a,b){var c=this.target,d=(b.getCurrentTarget(),cc.fadeOut(.3)),e=cc.callFunc(function(){c.layer.removeChild(c),c.visible=!1},c),f=cc.sequence(d,e);c.runAction(f)},onTouchDispose:function(a,b){var c=b.getCurrentTarget(),d=a.getLocation();c.x=d.x,c.y=d.y,c.stopAllActions()},update:function(){this.checkHit()},checkHit:function(){var a;for(a in this.layer.hitArr){var b=this.layer.hitArr[a],c=b.getBoundingBox(),d=this.getBoundingBox();cc.rectIntersectsRect(d,c)&&(this.layer.removeChild(this),this.visible=!1,this.type==b.type?(this.type<=3?(this.layer.scoreNum+=3,this.layer.tip.initWithFile(res.tip1)):(this.layer.scoreNum+=5,this.layer.tip.initWithFile(res.tip2)),this.layer.tip.visible=!0,this.layer.tip.runAction(this.layer.se),this.layer.scoreLabel.setString(this.layer.scoreNum)):console.log("0"))}}}),size={width:640,height:1024},X1=84,X2=size.width-84,Y1=size.height/2+0,Y2=size.height/2-200,Y3=size.height/2-400,info=[{x:X1,y:Y1,res:res.type1,type:1,ax:.5},{x:X1,y:Y2,res:res.type2,type:2,ax:.5},{x:X1,y:Y3,res:res.type3,type:3,ax:.5},{x:X2,y:Y1,res:res.type4,type:4,ax:.5},{x:X2,y:Y2,res:res.type5,type:5,ax:.5},{x:X2,y:Y3,res:res.type6,type:6,ax:.5}],resArr=[res.spr1,res.spr2,res.spr3,res.spr4,res.spr5,res.spr6],beginScene=cc.Scene.extend({ctor:function(){this._super();var a=new cc.Sprite(res.beginBg);a.x=size.width/2,a.y=size.height/2,this.addChild(a);var b=new cc.MenuItemImage(res.beginBtn,res.beginBtn,this.beginCall,this),c=new cc.Menu(b);c.x=size.width/2,c.y=250,this.addChild(c)},beginCall:function(){cc.director.runScene(new ruleScene)},onExit:function(){this.removeAllChildrenWithCleanup(!0)}}),ruleScene=cc.Scene.extend({ctor:function(){this._super();var a=new cc.Sprite(res.rule);a.x=size.width/2,a.y=size.height/2,this.addChild(a);var b=new cc.MenuItemImage(res.know,res.know,this.knowCall,this),c=new cc.Menu(b);c.x=size.width/2,c.y=250,this.addChild(c)},knowCall:function(){cc.director.runScene(new gameScene)},onExit:function(){this.removeAllChildrenWithCleanup(!0)}}),gameScene=cc.Scene.extend({tick:0,targets:[],typeArr:[],hitArr:[],tagNum:0,scoreNum:0,scoreLabel:null,timeNum:30,timeLabel:null,addItemFps:90,ctor:function(){this._super(),this.initBasic(),this.scheduleUpdate()},initBasic:function(){var a=new cc.Sprite(res.gameBg);a.x=size.width/2,a.y=size.height/2,this.addChild(a,0);var b=new cc.Sprite(res.topBarBg);b.x=size.width/2,b.anchorY=1,b.y=size.height,this.addChild(b,1e4),this.scoreLabel=new cc.LabelTTF("0","Arial",64),this.addChild(this.scoreLabel,1e4),this.scoreLabel.x=160,this.scoreLabel.y=size.height-50,this.timeLabel=new cc.LabelTTF("30","Arial",64),this.addChild(this.timeLabel,1e4),this.timeLabel.x=size.width-50,this.timeLabel.y=size.height-50,this.tip=new cc.Sprite(res.tip1),this.tip.x=size.width/2,this.tip.y=size.height-300,this.tip.visible=!1,this.tip.scale=.8,this.addChild(this.tip,1e4);var c=cc.scaleTo(.4,1),d=cc.callFunc(function(){this.tip.visible=!1,this.tip.scale=.8},this);this.se=cc.sequence(c,d);var e=new cc.Sprite(res.topBar);e.anchorY=1,e.x=size.width/2,e.y=size.height,this.addChild(e,1e3);for(var f=0;6>f;f++)this.typeArr[f]=new cc.Sprite(info[f].res),this.typeArr[f].anchorX=info[f].ax,this.typeArr[f].x=info[f].x,this.typeArr[f].y=info[f].y,this.typeArr[f].type=info[f].type,this.addChild(this.typeArr[f]),this.hitArr[f]=new cc.Sprite(res.hit),this.hitArr[f].y=info[f].y,this.hitArr[f].type=info[f].type,this.addChild(this.hitArr[f]),3>f?this.hitArr[f].x=info[f].x-30:this.hitArr[f].x=info[f].x+30},update:function(){if(this.tick++,this.tick%this.addItemFps==0&&this.addItem(),this.tick%60==0){if(this.timeNum--,this.timeNum<=0)return this.unscheduleUpdate(),void console.log("time out");this.timeNum<15&&(this.addItemFps=60),this.timeLabel.setString(this.timeNum)}},addItem:function(){var a=parseInt(6*Math.random()),b=new downSpr(resArr[a],a+1,this);b.scale=.45,b.x=size.width/2,b.y=size.height-320,this.addChild(b,1,this.tagNum++);var c=cc.moveTo(5,cc.p(size.width/2,0-b.getContentSize().height)),d=cc.callFunc(this.spriteMoveFinished,this);b.runAction(cc.sequence(c,d)),this.targets.push(b)},spriteMoveFinished:function(a){this.removeChild(a,!0);var b=this.targets.indexOf(a);b>-1&&this.targets.splice(b,1),this.tip.initWithFile(res.tip3),this.tip.visible=!0,this.tip.runAction(this.se)}}),MyLoaderScene=cc.Scene.extend({_interval:null,_length:0,_count:0,_label:null,_className:"MyLoaderScene",init:function(){var a=this,b=a._bgLayer=cc.LayerColor.create(cc.color(32,32,32,255));b.setPosition(cc.visibleRect.bottomLeft),a.addChild(b,0);var c=24,d=cc.director.getWinSize(),e=cc.Sprite.create(g_loadingPage);e.setPosition(d.width/2,d.height/2),e.setScale(1),b.addChild(e,0);var f=a._label=cc.LabelTTF.create("Loading... 0%","Arial",c);return f.setPosition(d.width/2,d.height/2-200),f.setColor(cc.color(255,255,255)),b.addChild(this._label,10),!0},_initStage:function(a,b){var c=this,d=c._texture2d=new cc.Texture2D;d.initWithElement(a),d.handleLoadedTexture();var e=c._logo=cc.Sprite.create(d);e.setScale(cc.contentScaleFactor()),e.x=b.x,e.y=b.y,c._bgLayer.addChild(e,10)},onEnter:function(){var a=this;cc.Node.prototype.onEnter.call(a),a.schedule(a._startLoading,.3)},onExit:function(){cc.Node.prototype.onExit.call(this);var a="Loading... 100%";this._label.setString(a)},initWithResources:function(a,b){"string"==typeof a&&(a=[a]),this.resources=a||[],this.cb=b},_startLoading:function(){var a=this;a.unschedule(a._startLoading);var b=a.resources;cc.loader.load(b,function(b,c,d){var e=d/c*100|0;e=Math.min(e,100),a._label.setString("Loading... "+e+"%")},function(){a.cb&&a.cb()})},_updatePercent:function(){var a=this,b=a._count,c=a._length,d=b/c*100|0;d=Math.min(d,100),a._label.setString("Loading... "+d+"%"),b>=c&&a.unschedule(a._updatePercent)}});MyLoaderScene.preload=function(a,b){var c=null;return c||(c=new MyLoaderScene,c.init()),c.initWithResources(a,b),cc.director.runScene(c),c};var thisismobile=!1;thisismobile=/AppleWebKit.*Mobile/i.test(navigator.userAgent)||/MIDP|SymbianOS|NOKIA|SAMSUNG|LG|NEC|TCL|Alcatel|BIRD|DBTEL|Dopod|PHILIPS|HAIER|LENOVO|MOT-|Nokia|SonyEricsson|SIE-|Amoi|ZTE/.test(navigator.userAgent)?!0:!1;