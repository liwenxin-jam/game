function accAdd(a,b){var c,d,e;try{c=a.toString().split(".")[1].length}catch(f){c=0}try{d=b.toString().split(".")[1].length}catch(f){d=0}return e=Math.pow(10,Math.max(c,d)),(a*e+b*e)/e}function accMul(a,b){var c=0,d=a.toString(),e=b.toString();try{c+=d.split(".")[1].length}catch(f){}try{c+=e.split(".")[1].length}catch(f){}return Number(d.replace(".",""))*Number(e.replace(".",""))/Math.pow(10,c)}function accDiv(arg1,arg2){var r1,r2,t1=0,t2=0;try{t1=arg1.toString().split(".")[1].length}catch(e){}try{t2=arg2.toString().split(".")[1].length}catch(e){}with(Math)return r1=Number(arg1.toString().replace(".","")),r2=Number(arg2.toString().replace(".","")),r1/r2*pow(10,t2-t1)}function resourceCallBack(){cc.game.onStart=function(){cc.view.adjustViewPort(!0),thisismobile?cc.view.setDesignResolutionSize(640,1024,cc.ResolutionPolicy.EXACT_FIT):cc.view.setDesignResolutionSize(640,1024,cc.ResolutionPolicy.SHOW_ALL),cc.view.resizeWithBrowserSize(!0),MyLoaderScene.preload(g_resources,function(){cc.spriteFrameCache.addSpriteFrames(res.packPlist,res.pack),cc.director.runScene(new gameScene)},this)},cc.game.run("gameCanvas")}var g_gameCount=6,g_gameTime=40,size={width:640,height:1024},beginScene=cc.Scene.extend({ctor:function(){this._super(),this.init()},init:function(){var a=new cc.Sprite(res.gameBg);a.x=size.width/2,a.y=size.height/2,this.addChild(a,0);var b=new cc.MenuItemImage(res.beginBtn,res.beginBtn,this.beginCall,this),c=new cc.Menu(b);c.x=size.width/2,c.y=size.height/2,this.addChild(c),this.scheduleUpdate()},update:function(){},beginCall:function(){cc.director.runScene(new ruleScene)}}),ruleScene=cc.Scene.extend({ctor:function(){this._super(),this.init()},init:function(){var a=new cc.Sprite(res.ruleBg);a.x=size.width/2,a.y=size.height/2,this.addChild(a,0);var b=new cc.MenuItemImage(res.knowBtn,res.knowBtn,this.knowCall,this),c=new cc.Menu(b);c.x=size.width/2,c.y=size.height/2,this.addChild(c),this.scheduleUpdate()},update:function(){},knowCall:function(){cc.director.runScene(new gameScene)}}),gameScene=cc.Scene.extend({score:0,ctor:function(){this._super(),this.init()},init:function(){var a=cc.director.getWinSize(),b=new cc.Sprite(res.gameBg);b.x=a.width/2,b.y=a.height/2,this.addChild(b,0);var c=new cc.Sprite("#time.png");c.setPosition(.31*a.width,.95*a.height),this.addChild(c,0);var d=this.time2=new cc.Sprite("#jdt1.png");d.setPosition(.065*c.width,.402*c.height),d.anchorX=0,c.addChild(d,0);var e=new cc.Sprite("#score.png");e.setPosition(.805*a.width,.95*a.height),this.addChild(e,0);var f=this.scoreText=new cc.LabelTTF("0","Microsoft YaHei",36);f.setPosition(.65*e.width,.5*e.height),e.addChild(f),this.scoreTemp=new cc.LabelTTF("","Microsoft YaHei",32),this.scoreTemp.setPosition(.5*a.width,.88*a.height),this.scoreTemp.color=cc.color.RED,this.addChild(this.scoreTemp);var g=new cc.Sprite("#small_kuang.png");g.setPosition(a.width-80,.3*a.height),this.addChild(g,0);var h=new cc.Sprite("#jian.png");h.setPosition(.2*g.width,.49*g.height),g.addChild(h,0),h.scale=.63,countTxt=new cc.LabelTTF(" X "+g_gameCount,"Microsoft YaHei",30),countTxt.setPosition(.6*g.width,.5*g.height),countTxt.color=cc.color(132,84,38),g.addChild(countTxt);var i=this.rope=new cc.Sprite("#ba.png");i.setPosition(.1*a.width,.71*a.height),this.addChild(i,0);var j=this.descLabel=new cc.LabelTTF("国企改革","Microsoft YaHei",28);j.setPosition(.5*i.width,.1*i.height),j.color=cc.color.RED,j.strokeStyle=cc.color.RED,j.fillStyle=cc.color.RED,i.addChild(j);var k=this.infinite=new cc.Sprite("#yuan.png");k.setPosition(.1*a.width,.765*a.height),this.addChild(k,0),k.runAction(cc.sequence(cc.moveBy(3,cc.p(1.1*a.width,0)),cc.callFunc(function(){j.setString("并购重组")})));var l=cc.view.getFrameSize();cc.sys.isMobile&&(k.scaleX=a.width/l.width*a.width/a.height*.93,k.scaleY=a.height/l.height*a.width/a.height*.93);var m=bow1=new cc.Sprite(res.bow_1);m.setPosition(.5*a.width,.145*a.height),this.addChild(m,0);var n=bow2=new cc.Sprite(res.bow_2);n.setPosition(.5*a.width,.1*a.height),this.addChild(n,0),n.visible=!1,arrow=new cc.Sprite("#jian.png"),arrow.setPosition(.5*a.width,.27*a.height),this.addChild(arrow,0),cc.eventManager.addListener(listener,arrow),zhiyin=new cc.Sprite("#zhiyin.png"),zhiyin.setPosition(.5*a.width,.13*a.height),zhiyin.runAction(cc.blink(.5,3)),this.addChild(zhiyin,0);var o=this.menuBack=new cc.MenuItemImage(res.js_guideBG,null,this.onStart,this);o.setPosition(.5*a.width,.5*a.height);var p=new cc.Menu(o);p.setPosition(0,0),this.addChild(p,1),this.countDown(),this.scheduleUpdate(),this.schedule(this.randomMove,3)},countDown:function(){this.schedule(function(){0>=g_gameTime&&!this.overFlag&&(this.overFlag=!0,g_gameTime=0,this.gameOver()),g_gameTime-=.1,this.time2.scaleX=g_gameTime/40},.1)},arr:["定向增发","业绩扭亏","高管增持","股权激励"],arrR:["国企改革","并购重组"],randomMove:function(){var a=1.5*Math.random()+2,b=cc.callFunc(function(){6==this.arrR.length?this.descLabel.setString(this.arrR[Math.floor(Math.random()*this.arrR.length)]):(this.descLabel.setString(this.arr[0]),this.arrR.push(this.arr[0]),this.arr.splice(0,1),console.log(this.arr),console.log(this.arr.length),console.log(this.arrR.length))},this);this.infinite.x>size.width/2?this.infinite.runAction(cc.sequence(cc.moveBy(a,cc.p(1.5*-size.width,0)),b)):this.infinite.runAction(cc.sequence(cc.moveBy(a,cc.p(1.5*size.width,0)),b))},addHole:function(a){var b=new cc.Sprite("#duang.png");b.x=a.x-16,b.y=a.y-18,this.infinite.addChild(b)},gameOver:function(){this.tempFlag||(this.tempFlag=!0,cc.director.pause())},update:function(){this.rope.x=this.infinite.x;var a=this.infinite.getBoundingBox(),b=arrow.getPosition();if(cc.rectContainsPoint(a,b)){arrow.stopAllActions(),arrow.y=.27*size.height,clickFlag=!1,arrow.scaleY=1;var c=Math.floor(1.21*(this.infinite.width/2-Math.abs(this.infinite.x-b.x))*10)/100;0>c&&(c=Math.abs(c)),this.scoreTemp.setString("+"+c),this.scoreTemp.scale=.3,this.scoreTemp.x=size.width/2,this.scoreTemp.y=.88*size.height,this.scoreTemp.runAction(cc.sequence(cc.fadeIn(.1),cc.scaleTo(.5,1.9),cc.scaleTo(.2,1.5),cc.delayTime(.8),cc.spawn(cc.scaleTo(.5,.1),cc.moveTo(.5,cc.p(600,900)),cc.fadeOut(.8)))),this.score=accAdd(this.score,c);var d=cc.p(b.x,this.infinite.y);d=this.infinite.convertToNodeSpace(d),this.addHole(d);var e=this.score+"";e.length>5&&(this.score=Math.floor(this.score)),console.log(this.score),this.scoreText.setString(this.score)}arrow.y>1.1*size.height&&(arrow.stopAllActions(),clickFlag=!1,arrow.y=.27*size.height,arrow.scaleY=1),0!=g_gameCount||this.overFlag||(this.overFlag=!0,cc.eventManager.removeAllListeners(),this.scheduleOnce(this.gameOver,1.5))}}),clickFlag=!1,listener=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:function(a,b){return clickFlag?void 0:(clickFlag=!0,zhiyin.visible=!1,bow1.visible=!1,bow2.visible=!0,arrow.runAction(cc.moveBy(.1,cc.p(0,.09*-cc.winSize.height))),!0)},onTouchMoved:function(a,b){b.getCurrentTarget(),a.getDelta()},onTouchEnded:function(){console.log("shoot"),bow1.visible=!0,bow2.visible=!1,arrow.runAction(cc.moveBy(.5,cc.p(0,cc.winSize.height))),arrow.runAction(cc.scaleTo(.5,1,.3)),g_gameCount--,countTxt.setString("X "+g_gameCount)}}),MyLoaderScene=cc.Scene.extend({_interval:null,_length:0,_count:0,_label:null,_className:"MyLoaderScene",init:function(){var a=this,b=a._bgLayer=cc.LayerColor.create(cc.color(32,32,32,255));b.setPosition(cc.visibleRect.bottomLeft),a.addChild(b,0);var c=24,d=cc.director.getWinSize(),e=cc.Sprite.create(g_loadingPage);e.setPosition(d.width/2,d.height/2),e.setScale(1),b.addChild(e,0);var f=a._label=cc.LabelTTF.create("Loading... 0%","Arial",c);return f.setPosition(d.width/2,d.height/2-200),f.setColor(cc.color(255,255,255)),b.addChild(this._label,10),!0},_initStage:function(a,b){var c=this,d=c._texture2d=new cc.Texture2D;d.initWithElement(a),d.handleLoadedTexture();var e=c._logo=cc.Sprite.create(d);e.setScale(cc.contentScaleFactor()),e.x=b.x,e.y=b.y,c._bgLayer.addChild(e,10)},onEnter:function(){var a=this;cc.Node.prototype.onEnter.call(a),a.schedule(a._startLoading,.3)},onExit:function(){cc.Node.prototype.onExit.call(this);var a="Loading... 100%";this._label.setString(a)},initWithResources:function(a,b){"string"==typeof a&&(a=[a]),this.resources=a||[],this.cb=b},_startLoading:function(){var a=this;a.unschedule(a._startLoading);var b=a.resources;cc.loader.load(b,function(b,c,d){var e=d/c*100|0;e=Math.min(e,100),a._label.setString("Loading... "+e+"%")},function(){a.cb&&a.cb()})},_updatePercent:function(){var a=this,b=a._count,c=a._length,d=b/c*100|0;d=Math.min(d,100),a._label.setString("Loading... "+d+"%"),b>=c&&a.unschedule(a._updatePercent)}});MyLoaderScene.preload=function(a,b){var c=null;return c||(c=new MyLoaderScene,c.init()),c.initWithResources(a,b),cc.director.runScene(c),c};var thisismobile=!1;thisismobile=/AppleWebKit.*Mobile/i.test(navigator.userAgent)||/MIDP|SymbianOS|NOKIA|SAMSUNG|LG|NEC|TCL|Alcatel|BIRD|DBTEL|Dopod|PHILIPS|HAIER|LENOVO|MOT-|Nokia|SonyEricsson|SIE-|Amoi|ZTE/.test(navigator.userAgent)?!0:!1;