function resourceCallBack(){cc.game.onStart=function(){cc.view.adjustViewPort(!0),thisismobile?cc.view.setDesignResolutionSize(640,1024,cc.ResolutionPolicy.EXACT_FIT):cc.view.setDesignResolutionSize(640,1024,cc.ResolutionPolicy.SHOW_ALL),cc.view.resizeWithBrowserSize(!0),MyLoaderScene.preload(g_resources,function(){cc.director.runScene(new gameScene)},this)},cc.game.run("gameCanvas")}function randomArr(){for(var a=1,b=0,c=[],d=0;8>d;d++){a=1,b=parseInt(8*Math.random()+1);for(var e=0;d>e;e++)c[e]==b&&(a=0,d--);1==a&&c.push(b)}return c}var MyLoaderScene=cc.Scene.extend({_interval:null,_length:0,_count:0,_label:null,_className:"MyLoaderScene",init:function(){var a=this,b=a._bgLayer=cc.LayerColor.create(cc.color(32,32,32,255));b.setPosition(cc.visibleRect.bottomLeft),a.addChild(b,0);var c=24,d=cc.director.getWinSize(),e=cc.Sprite.create(g_loadingPage);e.setPosition(d.width/2,d.height/2),e.setScale(1),b.addChild(e,0);var f=a._label=cc.LabelTTF.create("Loading... 0%","Arial",c);return f.setPosition(d.width/2,d.height/2-200),f.setColor(cc.color(255,255,255)),b.addChild(this._label,10),!0},_initStage:function(a,b){var c=this,d=c._texture2d=new cc.Texture2D;d.initWithElement(a),d.handleLoadedTexture();var e=c._logo=cc.Sprite.create(d);e.setScale(cc.contentScaleFactor()),e.x=b.x,e.y=b.y,c._bgLayer.addChild(e,10)},onEnter:function(){var a=this;cc.Node.prototype.onEnter.call(a),a.schedule(a._startLoading,.3)},onExit:function(){cc.Node.prototype.onExit.call(this);var a="Loading... 100%";this._label.setString(a)},initWithResources:function(a,b){"string"==typeof a&&(a=[a]),this.resources=a||[],this.cb=b},_startLoading:function(){var a=this;a.unschedule(a._startLoading);var b=a.resources;cc.loader.load(b,function(b,c,d){var e=d/c*100|0;e=Math.min(e,100),a._label.setString("Loading... "+e+"%")},function(){a.cb&&a.cb()})},_updatePercent:function(){var a=this,b=a._count,c=a._length,d=b/c*100|0;d=Math.min(d,100),a._label.setString("Loading... "+d+"%"),b>=c&&a.unschedule(a._updatePercent)}});MyLoaderScene.preload=function(a,b){var c=null;return c||(c=new MyLoaderScene,c.init()),c.initWithResources(a,b),cc.director.runScene(c),c};var thisismobile=!1;thisismobile=/AppleWebKit.*Mobile/i.test(navigator.userAgent)||/MIDP|SymbianOS|NOKIA|SAMSUNG|LG|NEC|TCL|Alcatel|BIRD|DBTEL|Dopod|PHILIPS|HAIER|LENOVO|MOT-|Nokia|SonyEricsson|SIE-|Amoi|ZTE/.test(navigator.userAgent)?!0:!1;var _size=0,step=0,GameLayer=null,endLayer=null,centerX=320,centerY=497,space=160,sprArr=[],beginMove=!1,sprInfo=[],sprInfoTemp=function(){return[{x:centerX-space,y:centerY+space,row:0,col:0,flag:0},{x:centerX,y:centerY+space,row:1,col:0,flag:1},{x:centerX+space,y:centerY+space,row:2,col:0,flag:2},{x:centerX-space,y:centerY,row:0,col:1,flag:3},{x:centerX,y:centerY,row:1,col:1,flag:4},{x:centerX+space,y:centerY,row:2,col:1,flag:5},{x:centerX-space,y:centerY-space,row:0,col:2,flag:6},{x:centerX,y:centerY-space,row:1,col:2,flag:7},{x:centerX+space,y:centerY-space,row:2,col:2,flag:8}]},gameScene=cc.Scene.extend({ctor:function(){this._super(),this.init()},init:function(){_size=cc.director.getWinSize();var a=this;endLayer=new gameEndLayer,this.addChild(endLayer),GameLayer=new gameLayer,this.addChild(GameLayer);var b=new ruleLayer;this.addChild(b,2);var c=new beginLayer(b,a);this.addChild(c,3),this.scheduleUpdate()},update:function(){}}),globalRandomArr=[],beginLayer=cc.Layer.extend({ctor:function(){this._super();var a=new cc.Sprite(res.beginBg);a.x=_size.width/2,a.y=_size.height/2,this.addChild(a,0);var b=new cc.MenuItemImage(res.beginBtn,res.beginBtn,this.btnCallFun,this),c=new cc.Menu(b);c.x=_size.width/2,c.y=_size.height/2-100,this.addChild(c,1)},deleteThis:function(){this.removeFromParent(!0)},btnCallFun:function(){this.deleteThis()}}),ruleLayer=cc.Layer.extend({ctor:function(){this._super();var a=new cc.Sprite(res.ruleBg);a.x=_size.width/2,a.y=_size.height/2,this.addChild(a,0);var b=new cc.MenuItemImage(res.ruleBtn,res.ruleBtn,this.btnCallFun,this),c=new cc.Menu(b);c.x=_size.width/2,c.y=_size.height/2-50,this.addChild(c)},deleteThis:function(){this.removeFromParent(!0)},btnCallFun:function(){this.deleteThis(),GameLayer.startGame()}}),gameLayer=cc.Layer.extend({gameScoreText:null,ctor:function(){this._super(),sprInfo=sprInfoTemp();var a=new cc.Sprite(res.gameBg);a.x=_size.width/2,a.y=_size.height/2,this.addChild(a),this.gameScoreText=new cc.LabelTTF("0","bold 宋体",46),this.gameScoreText.x=_size.width/2,this.gameScoreText.y=_size.height/2+350,this.gameScoreText.fillStyle=new cc.color(255,255,255,255),this.addChild(this.gameScoreText,2),this.gameScoreText.visible=!1;var b=new cc.Sprite(res.main);b.x=_size.width-100,b.y=_size.height-100,this.addChild(b),b.scale=.3},startGame:function(){var a=this;sprArr[0]=new touchSprite(sprInfo[0].x,sprInfo[0].y,sprInfo[0].row,sprInfo[0].col,null,null,0,a),this.addChild(sprArr[0]);for(var b=1;9>b;b++)sprArr[b]=new touchSprite(sprInfo[b].x,sprInfo[b].y,sprInfo[b].row,sprInfo[b].col,b,b,1,a),this.addChild(sprArr[b])},deleteThis:function(){this.removeFromParent(!0)},reNewScore:function(a){this.gameScoreText.setString(""+a)}}),gameEndLayer=cc.Layer.extend({ctor:function(){this._super();var a=new cc.Sprite(res.gameEnd);a.x=_size.width/2,a.y=_size.height/2,this.addChild(a,0);var b=new cc.MenuItemImage(res.again,res.again,this.againBtnCallFun,this),c=new cc.Menu(b);c.x=_size.width/2-160,c.y=_size.height/2,this.addChild(c);var d=new cc.MenuItemImage(res.more,res.more,this.moreBtnCallFun,this),e=new cc.Menu(d);e.x=_size.width/2+160,e.y=_size.height/2,this.addChild(e)},againBtnCallFun:function(){var a=this;a.deleteThis(),cc.director.runScene(new gameScene)},moreBtnCallFun:function(){window.location.href=g_link},deleteThis:function(){this.removeFromParent(!0)},showEndScore:function(){console.log(step);var a=new cc.LabelTTF(""+step,"bold 宋体",46);a.x=_size.width/2,a.y=_size.height/2+350,a.fillStyle=new cc.color(255,255,255,255),this.addChild(a,2)}}),touchSprite=cc.Sprite.extend({numArr:[],ctor:function(a,b,c,d,e,f,g,h){this._super();var i=cc.textureCache.addImage(res.main),j=new cc.SpriteFrame(i,cc.rect(160*c,160*d,160,160));this.setSpriteFrame(j),this.x=a,this.y=b,this.tag=g,this.layer=h,null==this.num?null:e,null==this.M?null:f,this.loadListener()},loadListener:function(){var a=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,target:this,swallowTouches:!0,onTouchBegan:this.onTouchBegan,onTouchMoved:this.onTouchMoved,onTouchEnded:this.onTouchEnded});cc.eventManager.addListener(a,this)},onTouchBegan:function(a,b){var c=this.target,d=c.convertToNodeSpace(a.getLocation()),e=c.getContentSize(),f=cc.rect(0,0,e.width,e.height);return cc.rectContainsPoint(f,d)?!0:!1},onTouchMoved:function(a,b){this.target},onTouchEnded:function(a,b){var c=this.target,d=c.tag;if(0!=d||beginMove)0!==d&&beginMove&&(c.dealSuccess(c.layer),c.onTouchDispose(a,b,c));else{beginMove=!0,c.layer.removeChild(c.layer.getChildByTag(d)),sprInfo[0].flag=null,globalRandomArr=randomArr();for(var e=1;8>=e;e++)sprArr[e].x=sprInfo[globalRandomArr[e-1]].x,sprArr[e].y=sprInfo[globalRandomArr[e-1]].y,sprArr[e].num=globalRandomArr[e-1],sprArr[e].M=e}},onTouchDispose:function(a,b,c){var d=b.getCurrentTarget();switch(d.numArr=[],d.num){case 0:d.numArr=[1,3];break;case 1:d.numArr=[0,2,4];break;case 2:d.numArr=[1,5];break;case 3:d.numArr=[0,4,6];break;case 4:d.numArr=[1,3,5,7];break;case 5:d.numArr=[2,4,8];break;case 6:d.numArr=[3,7];break;case 7:d.numArr=[4,6,8];break;case 8:d.numArr=[5,7]}c.checkTNarr(d.numArr,b)},checkTNarr:function(a,b,c){step++,GameLayer.reNewScore(step);for(var d=b.getCurrentTarget(),e=0;e<a.length;e++)null==sprInfo[a[e]].flag&&(sprInfo[d.num].flag=null,sprInfo[a[e]].flag=d.num,d.x=sprInfo[a[e]].x,d.y=sprInfo[a[e]].y,d.num=a[e])},dealSuccess:function(a){for(var b=!0,c=1;9>c;c++)if(sprArr[c].num!=sprArr[c].M){b=!1;break}b?(a.addChild(sprArr[0],1e4),setTimeout(function(){console.log("ye complete"),a.deleteThis(),beginMove=!1,endLayer.showEndScore()},2e3)):console.log("nnn")}});